hw08 - Maps
================
Shirisha Biyyala
2024-11-27

## Load packages

``` r
library(tidycensus)
library(dplyr)
library(tigris)
library(ggplot2)
library(sf)
```

## Set up and verify API Key

``` r
# census_api_key("YOUR_API_KEY_removed", install = TRUE)

test_data <- get_acs(geography = "state", variables = "B01003_001", year = 2022)
```

    ## Getting data from the 2018-2022 5-year ACS

``` r
head(test_data)
```

    ## # A tibble: 6 × 5
    ##   GEOID NAME       variable   estimate   moe
    ##   <chr> <chr>      <chr>         <dbl> <dbl>
    ## 1 01    Alabama    B01003_001  5028092    NA
    ## 2 02    Alaska     B01003_001   734821    NA
    ## 3 04    Arizona    B01003_001  7172282    NA
    ## 4 05    Arkansas   B01003_001  3018669    NA
    ## 5 06    California B01003_001 39356104    NA
    ## 6 08    Colorado   B01003_001  5770790    NA

API key has been setup and the data preview indicates that the API is
working correctly.

## Load variables

``` r
# Load the list of variables 
variables <- load_variables(year = 2022, dataset = "acs1")

# Preview the variables
head(variables)
```

    ## # A tibble: 6 × 3
    ##   name        label                                   concept                 
    ##   <chr>       <chr>                                   <chr>                   
    ## 1 B01001A_001 Estimate!!Total:                        Sex by Age (White Alone)
    ## 2 B01001A_002 Estimate!!Total:!!Male:                 Sex by Age (White Alone)
    ## 3 B01001A_003 Estimate!!Total:!!Male:!!Under 5 years  Sex by Age (White Alone)
    ## 4 B01001A_004 Estimate!!Total:!!Male:!!5 to 9 years   Sex by Age (White Alone)
    ## 5 B01001A_005 Estimate!!Total:!!Male:!!10 to 14 years Sex by Age (White Alone)
    ## 6 B01001A_006 Estimate!!Total:!!Male:!!15 to 17 years Sex by Age (White Alone)

### Part 1: State-Level Data and Mapping

#### Step 1: Load State-Level Data

``` r
# Download state-level population data
state_data <- get_acs(geography = "state", variables = "B01003_001", year = 2022, survey = "acs1")
```

    ## Getting data from the 2022 1-year ACS

    ## The 1-year ACS provides data for geographies with populations of 65,000 and greater.

``` r
# Preview the data
head(state_data)
```

    ## # A tibble: 6 × 5
    ##   GEOID NAME       variable   estimate   moe
    ##   <chr> <chr>      <chr>         <dbl> <dbl>
    ## 1 01    Alabama    B01003_001  5074296    NA
    ## 2 02    Alaska     B01003_001   733583    NA
    ## 3 04    Arizona    B01003_001  7359197    NA
    ## 4 05    Arkansas   B01003_001  3045637    NA
    ## 5 06    California B01003_001 39029342    NA
    ## 6 08    Colorado   B01003_001  5839926    NA

#### Step 2: Download US State Shapefiles

``` r
# Download state shapefiles
state_shapes <- states(cb = TRUE)
```

    ## Retrieving data for the year 2021

    ##   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |==                                                                    |   4%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |==========================================================            |  84%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%

#### Step 3: Merge Data Using State Names

``` r
# Convert state names to lowercase for consistency
state_data <- state_data %>%
  mutate(NAME = tolower(NAME))
state_shapes <- state_shapes %>%
  mutate(NAME = tolower(NAME))

# Merge the data using state names
state_map_data <- left_join(state_shapes, state_data, by = "NAME")

# Check the merged data
head(state_map_data)
```

    ## Simple feature collection with 6 features and 13 fields
    ## Geometry type: MULTIPOLYGON
    ## Dimension:     XY
    ## Bounding box:  xmin: -179.1489 ymin: -14.5487 xmax: 179.7785 ymax: 71.36516
    ## Geodetic CRS:  NAD83
    ##   STATEFP  STATENS    AFFGEOID GEOID.x STUSPS           NAME LSAD        ALAND
    ## 1      56 01779807 0400000US56      56     WY        wyoming   00 2.514587e+11
    ## 2      02 01785533 0400000US02      02     AK         alaska   00 1.478943e+12
    ## 3      24 01714934 0400000US24      24     MD       maryland   00 2.515199e+10
    ## 4      60 01802701 0400000US60      60     AS american samoa   00 1.977591e+08
    ## 5      05 00068085 0400000US05      05     AR       arkansas   00 1.346608e+11
    ## 6      38 01779797 0400000US38      38     ND   north dakota   00 1.786943e+11
    ##         AWATER GEOID.y   variable estimate moe                       geometry
    ## 1   1867503716      56 B01003_001   581381  NA MULTIPOLYGON (((-111.0546 4...
    ## 2 245378425142      02 B01003_001   733583  NA MULTIPOLYGON (((179.4825 51...
    ## 3   6979074857      24 B01003_001  6164660  NA MULTIPOLYGON (((-76.05015 3...
    ## 4   1307243751    <NA>       <NA>       NA  NA MULTIPOLYGON (((-168.1458 -...
    ## 5   3121950081      05 B01003_001  3045637  NA MULTIPOLYGON (((-94.61792 3...
    ## 6   4414779956      38 B01003_001   779261  NA MULTIPOLYGON (((-104.0487 4...

#### Step 4: Plot the US Map

##### Step 4.1: Your first map

``` r
# Create the map
state_map_data %>%
  ggplot(aes(fill = estimate)) +
    geom_sf()  +
    coord_sf(crs = st_crs(5070))  +
    labs(title = "Population by State (2022)", fill = "Population") +
    theme_minimal()
```

![](hw08_files/figure-gfm/basic-map-1.png)<!-- -->

##### Step 4.2: Wait a sec!
