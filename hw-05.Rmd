---
title: "HW 05 - Legos"
author: "Shirisha Biyyala"
date: " `r Sys.Date()` "
output: github_document
---

## Load packages and data

```{r load-packages-and-data, message = FALSE}
#install.packages("tidyverse")
library(tidyverse)
load("data/lego_sales.rda")
```

```{r view-data}
view(lego_sales)
glimpse(lego_sales)

# Get the head of the data set
lego_head <- head(lego_sales)
lego_head

# Get the tail of the data set
lego_tail <- tail(lego_sales)
lego_tail
```


## Exercises

### Exercise 1

In this sample, the first three common names of purchasers are **Jackson**, **Jacob** and **Joseph**.

```{r common-first-names}
lego_sales %>%
  count(first_name) %>%
  arrange(desc(n)) %>%
  slice_max(n, n = 3)
```


### Exercise 2

In this sample, the three most common themes of Lego sets purchased are:

1. **Star Wars** (75 purchases)
2. **Nexo Knights** (64 purchases)
3. **Gear** and **Mixels** (both with 55 purchases each)

```{r most-common-themes}
lego_sales %>%
  count(theme) %>%
  arrange(desc(n)) %>%
  slice_max(n, n = 3)
```


### Exercise 3

Among the most common themes of Lego sets purchased, the most common subtheme is:

- **The Force Awakens** (15 purchases)


```{r most-common-subtheme}
lego_sales %>%
  group_by(theme) %>%
  mutate(theme_count  = n()) %>%  
  ungroup() %>%
  filter(theme_count  == max(theme_count )) %>%  
  count(subtheme) %>%
  slice_max(n, n = 1)
```

### Exercise 4

```{r age-grouping}
lego_sales <- lego_sales %>%
  mutate(age_group = case_when(
    age <= 18 ~ "18 and under",
    age >= 19 & age <= 25 ~ "19 - 25",
    age >= 26 & age <= 35 ~ "26 - 35",
    age >= 36 & age <= 50 ~ "36 - 50",
    age > 50 ~ "51 and over"
  ))
```

```{r age-group-info}
#Show sample data with selected columns
lego_sales %>% 
  select(first_name, last_name, age, age_group)
```

### Exercise 5

The age group with the highest purchases is:

- **36 - 50** (313 purchases)

```{r highest-purchases}
lego_sales %>%
  group_by(age_group) %>%
  summarise(highest_purchases = sum(quantity)) %>%
  arrange(desc(highest_purchases)) %>%
  slice_max(highest_purchases, n = 1)
```


### Exercise 6

...

### Exercise 7

...

### Exercise 8

...

### Exercise 9

...
